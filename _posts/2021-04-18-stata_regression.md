---
layout: post
permalink: /stata/dcando_stata_regression1
title: '예제를통한계량경제학 1장 풀이'
date: 2021-04-18 09:30:00 +09:00
feature: '/img/posts/stata-regression/stata1_thumbnail.jpeg'
background: '/img/posts/stata-regression/stata1_back.png'
categories:
  - category-stata
tags:
  - 예제를통한계량경제학
  - 예제를통한계량경제학 정답지
  - 회기분석
  - 통계
  - 구자라티
  - 회기분석가설검증
description: '구자라티도 지도교수님도 제대로 안 알려주는 회귀분석'
---

## 마케터D가 알려주는 오늘의 통계풀이: 회기분석

계량경제분석, 통계분석을 해본 사람이면 안다. 사실 회귀모형이 가장 쉬운 분석방법이었다는 걸.
하지만 주니어 석사생은 회귀니, 로짓이니 모형 이름만 들어도 힘이 빠지는게 현실.
그래서 선배들에게 책이름 조차 어려운 “다모다르 구자라티의 계량경제학”을 추천받는다.
하지만 악순환은 끝나지 않는다. 책이 한국어인데.. 분명 한국어로 쓰여져있는데 이해가 안된다.
그래도 도전해본다. 구자라티도, 지도교수님도 제대로 설명해주지 않는 수많은 분석모형들,  마케터D가 풀이해보겠다.

## 1장 회귀모형
1장 회귀모형이다. 여기선 아래 2가지에 초첨을 맞추고 분석을 진행하겠다.
회귀분석 후 결과값을 어떻게 해석해야하는지
회귀분석 후 진행해야하는 추가 필수 분석은 무엇인지, 왜 해야하는지

문제a~j를 “꼼꼼히, 그리고 뾰족하게” 읽어보길 바란다.
분석 완료 후, 연구자단에서 스스로 팔로업/ 검증해야하는 추가분석과 관련된 질문들이니 말이다.

> 구자라티의 계량경제 연습문제 1장을 해결하는 것으로 회귀모형 설명을 대신하겠다. 분석도구는 Stata이다.
Stata 내 하위메뉴들을 클릭하여 분석해도 되지만, 나는 편의상 축약어를 코드로 검색했다.
축약어는 별도로 표시하였으니 코드창에 복붙하면 된다.

### 문제: 1970년 후반 보스턴 동부지역의 3~19세의 654명의 청년에 관하여 다음과 같은 변수를 보여주고 있다. 

> code: .sum 
![이미지1](/img/posts/stata-regression/1_sum.png)

#### 문제a/ 이러한 목적에 적합한 회귀모형을 수립하라
이를 수식으로 풀어낸다면 다음과 같다. 
호흡량(fev) = smoke(흡연유무) + age(연령) + ht(키높이) + sex(성별) 	Y = -0.087(흡연유무) + 0.065(연령) + 0.104(키높이) + 0.157(성별)
즉, 미국 동부지역에 거주하는 654명 청년들의 호흡량에 영향을 미치는 이 원인들(흡연유무, 연령, 키높이, 성별 등)의 개별 “영향도”를 측정하는 것이다. 그리고 우리는 이를 “회귀분석"이라 부른다.

#### 문제b/ 분석에 앞서 각 회귀변수가 fev에 미치는 효과는 무엇일까? 회귀분석의 결과가 사전적인 예측을 입증하는가?
폐기능 호흡량에 영향을 미치는 원인은 그 사람의 흡연유무, 연령대, 키높이, 성별라고 할 수 있다. -  흡연자는 비흡연자보다 폐기능(호흡량)이 0.087L만큼 낮다 -  나이가 1년씩 증가할 때마다 폐기능(호흡량)은 0.065L씩 증가한다   키높이가 1인치 증가할 때마다 폐기능(호흡량)은 0.104L씩 증가한다. - 남자가 여자보다 폐기능(호흡량)이 0.157L 좋다(높다).

#### 문제c/ 설명변수 중에 어떤 것이 5% 유의수준에서 각각 통계적으로 유의미한가?  추정된 p값은 각각 얼마인가?
연령, 키높이, 성별은 각각 5% 유의수준에서 통계적으로 유의하다. 즉 5%유의수준에서 통계적으로 “말이 맞다”라고 표현할 수 있는 애들이 이 세 변수라는 거. -  흡연습관은 p값이 0.141로 5% 유의수준에서 통계적으로 유의하지않다. 

#### 문제d/ 추정된 p값이 5%의 값보다 크다면, 관련된 회귀계수가 실제로 중요하지 않다는 것을 의미하는가? 
p값이 5%에서 수준에서 유의하지 않다는 것은 통계적으로 유의한 의미가 없다는 뜻이다. 회귀계수 그 자체가 중요하지 않다는 것을 의미하지는 않는다. 즉, 영향도가 없다고 판단하고 이 변수는 신경쓰지말자는 거. 
하지만, 사회과학에서는 통계적 유의수준도 중요하지만 연구자의 가설을 설명하는 유무가 더 중요하다는 건 덤으로 알아두기. 

#### 문제e/  당신은 나이와 키높이가 상관관계가 있다고 예상하는가? 만약 그렇다면, 당신의 모형이 다중공선성의 문제를 예견할 수 있지 않은가? 이 문제에 대하여 무엇을 할 수 있을 지 아이디어 는 있는가? 필요한 계산과정을 보여라. 만약 답이 없다면 제 4장에서 다중공선성을 깊게 다룰 예정이기 때문에 낙심하지 마시기 바랍니다.
키높이와 연령대가 가장 강한 상관관계를 지닌다. 상관관계를 찾는 방법은 아래 코드로 진행. Call)부분의 명령어를 입력할 것. 
> code: .pwcorr smoke age ht sex 

> 코드설명: pwcorr은 두개 이상의 변수가 있을 때 두개씩 짝지어 상관관계를 계산한다./ pw는 painwise를 의미. 

![이미지3](/img/posts/stata-regression/3_pworr-somke-age-ht-sex.png)

위와 같은 표의 결과가 나왔다. 이를 해석하기 위하여 [여기 사이트](https://gomguard.tistory.com/173)의 도움을 받았다. 페이지 내용에 따르면, r값은 아래 기준점에 따라 그 의미가 달라진다.
* +0.7   ~  +1.0 : 강한 양적 상관관계
* +0.3   ~  +0.7 : 뚜렷한 양적 상관관계 
* +0.1   ~  +0.3 : 약한 양적 상관관계 
* -0.1   ~  +0.1 : 상관관계 거의 없음 
* -0.7   ~  -0.3  : 뚜렷한 음적 상관관계 
* -1.0  ~ -0.7  :  강한 음적 상관관계

이를 해석하자면,

1. 연령대와 흡연유무는 뚜렷한 양적 상관관계를 가진다.

2. 키높이와 흡연유무는 약한 양적 상관관계를 가진다. 키높이와 연령대는 강한 양적 상관관계를 가진다. 성별과 흡연유무는 강한 음적 상관관계를 가진다. 성별과 연령대는 상관관계가 거의 없다. 성별과 키높이는 상관관계가 거의 없다.

3. 연령대와 흡연유무가 뚜렷한 양적 상관관계를 가지기 때문에 모형이 다중공선성 문제를 일으킬 수 있겠다. 

> 모형: 호흡량(fev) = smoke(흡연유무) + age(연령) + ht(키높이) + sex(성별) 
> 다중공선성: 설명변수 간 하나 이상의 선형관관계가 있을 때 다중공선성이 발생했다고 말함. 고전적 선형회귀모형(CLRM)의 가정 중 하나는 설명변수 간에 선형관계가 없음.  

4. 위와같이 설명변수간에 선형성이 존재하면 통계적추론이 불안정하게 된다. 만약 두 변수 간에 높은 선형성이 존재하면 각 변수들의 독립적으로 종손변수에 미치는 영향을 분리하기가 매우 어렵다(책 p.94).  

5. 다중공선성을 검정하는 유일한 방법은 없다. 다음과 같이 문헌에서 논의하는 검정방법은 몇 가지가 있다. 
  * 1) 높은 𝑅2과 낲은t값 신뢰도,
  * 2) 설명변수 또는 회귀자 중에 두 변수간 높은 상관계수 (책 p.99). 설명변수 간의 높은 상관계수는 공선성의 증표이다. 따라서 설명변수 간의 상관계수가 높은 변수는 분석에서 제외해야 한다. 그러나 단순하게, 두 변수 간 상관계수에 의존하여 판단하는 것은 좋은 습관이 아니다. 왜냐하면 두 변수 간의 상관계수를 구할 때, 모형 내 의 다른 변수들이 일정하지 않기 때문이다(책 p.99).

 6. 하나의 주의사항이 있다. 모형 내에 다중공선성이 존재하지만, 회귀분석의 목표가 예측에 있다면, 표본 내에서 선형관계가 예측기간 동안 일정하게 유지만 된다면, 다중공선성은 매우 나쁜 것만은 아니다(p.106).
> vif 로 돌려본 결과 mean vif가 2.03이므로 높은 수준의 선형성이 존재한다는 것을 알 수 있다(계량경제 책 p.101) 

> code: .vif 
![이미지4](/img/posts/stata-regression/4_vif.png)

#### 문제f/ 독자들은 모든(기울기)계수가 통계적으로 유의미하지 않다는 가설을 기각할 수 있는가? 어떠한 검정방법이 유용할까? 필요한 계산과정을 보여라. 
책<사회과학 통계방법> p.421 인용) 연구자가 회귀모형으로 자료를 분석하는 목적은 종속변수 Y를 예측하는 변수로서 연구자가 설정한 설명변수 X가 유의한 효과를 갖는지 알 기 위한 것이다. 이를 위해 연구자가 두 가지 맥락에서 회귀모형에 대한 가설검정 수행한다.

이 가설검정을 수행하는 방법으로서 두 가지가 있는데 두번째 방법이 바로 연구자가 선정한 설명변수 X가 종속변수 Y를 예측하는데 통계적으로 유의한지를 검정하는 것이다. 이 경우 연구자는 설명변수 X의 효과인 회귀계수가 통계적으로 유의한지를 검정한다.

(책 p.427) 이때 영가설(회기계수=0)을 검정하는 확률분포는 t-분포이다. 따라서 기울기계수 가 통계적으로 유의미하지 않다는 가설은 t검정을 통해 판단할 수가 있다.

#### 문제g/ 분산분석(analysis of variance)표를 만들어보아라. 그 표가 의미하는 바는 무엇인가?
	> Code/ .anova fev smoke age c.ht sex 
  > 코드설명: C를 ht앞에 붙여주는 이유는 ht가 정수가 아니고, 이산변수가 아니기 때문에 categorizing해주 기 위해서임.
  ![이미지5](/img/posts/stata-regression/5_anova-fev-smoke-age-c_ht-sex.png)

Anova table을 통해 종속변수와 독립변수 간의 상호작용 결과를 볼 수가 있다. 즉, 상기 표에서는 흡연유무, 연령대, 키높이, 성별의 p값이 유의수준 5%에서 유의했기 때문에 네 개의 변수들은 종속변수인 폐기능(호흡량)에 유의한 영향을 미쳤다고 볼 수 있다.

#### 문제h/ 회귀모형의 𝑹𝟐값은 얼마인가? 그 수치를 어떻게 해석할 것인가?
𝑅2값은 0.7753이다. 이것은 폐기능(호흡량)에 영향을 미치는 설명변수들(흡연유무, 연령, 키높이, 성별)이 종속  변수인 폐기능을 77.5% 설명한다고 볼 수 있다.

#### 문제i/ 조정된𝑹값을계산하라.?이값과(h)의𝑹값을어떻게비교할것인가?
  조정된 R 값은 0.7740이다. 𝑅2의 단점은 설명변수의 수가 증가함에 따라 값이 증가하는 함수라는 것이다. 즉, 회귀분석 모형에 하나의 변수를 더 추가하면, 𝑅2의 값이 더 증가한다. 이러한 유혹을 회피하기 위하여, 반드시 회귀분석모형에서 설명변수의 수를 고려해야 한다. 설명변수의 수를 고려하여 다중회귀모형에서는 조정된 R 값이 모형을 더 잘 설명해준다고 볼 수 있다 (책 p.17). 조정된 R값은 종종 동일한 종속변수인 2개 또는 그 이상의 모형의 회귀모형을 비교하는 데 사용된다(책 p.17).

#### 문제j/ 이 예제로부터 흡연이 fev에 나쁘다는 결론을 내릴 수 있는가? 설명하라. 
회귀계수로만 판단했을 때, 흡연유무의 회귀계수가 -0.0872로 나왔기 때문에 흡연이 폐기 능에 악영향을 미친다고 말할 수는 있다.
